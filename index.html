<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opalgas Drive Connector</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700&display=swap');
        body { font-family: 'Plus+Jakarta+Sans', sans-serif; }
    </style>
</head>
<body class="bg-[#f8fafc] min-h-screen flex items-center justify-center p-4">

    <div class="max-w-md w-full bg-white rounded-[2rem] shadow-2xl shadow-blue-100/50 p-10 border border-slate-100">
        <!-- Icon -->
        <div class="w-24 h-24 bg-gradient-to-tr from-blue-600 to-blue-400 rounded-3xl flex items-center justify-center mx-auto mb-8 shadow-xl shadow-blue-200">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
        </div>

        <h1 class="text-3xl font-bold text-slate-800 text-center mb-3">Opalgas Drive</h1>
        <p class="text-slate-500 text-center text-sm mb-10 leading-relaxed">Hubungkan repositori GitHub Anda dengan Google Drive untuk akses file seumur hidup.</p>

        <!-- Auth Section -->
        <div id="auth_section" class="space-y-4">
            <button onclick="handleAuthClick()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-5 rounded-2xl transition-all active:scale-[0.98] shadow-lg shadow-blue-100 flex items-center justify-center gap-3">
                <span>Hubungkan ke Google Drive</span>
            </button>
            <p class="text-[10px] text-center text-slate-400 uppercase tracking-widest font-semibold">Memerlukan Client ID Google Cloud</p>
        </div>

        <!-- Success Section (Hidden by default) -->
        <div id="status_section" class="hidden space-y-6 animate-in fade-in duration-500">
            <div class="flex items-center gap-4 p-4 bg-emerald-50 border border-emerald-100 rounded-2xl text-emerald-700">
                <div class="bg-emerald-500 rounded-full p-1 text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                </div>
                <span class="font-bold text-sm text-emerald-800">Koneksi Berhasil Terjalin</span>
            </div>
            
            <button onclick="buatFolderTes()" class="w-full bg-slate-900 text-white font-bold py-5 rounded-2xl hover:bg-black transition-all shadow-xl flex items-center justify-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"></path></svg>
                Buat Folder "Opalgas-LifeTime"
            </button>
        </div>

        <!-- Console Log -->
        <div id="log_box" class="mt-10 p-5 bg-slate-50 border border-slate-100 rounded-2xl text-left font-mono text-[11px] text-slate-600 h-32 overflow-y-auto scrollbar-hide">
            <span class="text-blue-500 font-bold">system:</span> Menunggu input...
        </div>
    </div>

    <script>
        /**
         * PENTING: Masukkan Client ID Anda di bawah ini
         */
        const CLIENT_ID = '16352551071-3v31b6irthqrefa7re3hpbn7peh6rile.apps.googleusercontent.com';
        const SCOPES = 'https://www.googleapis.com/auth/drive.file';

        let tokenClient;
        let accessToken = null;

        function log(msg, type = 'info') {
            const box = document.getElementById('log_box');
            const color = type === 'error' ? 'text-red-500' : 'text-blue-500';
            box.innerHTML += `<br><span class="${color} font-bold">${type}:</span> ${msg}`;
            box.scrollTop = box.scrollHeight;
        }

        function handleAuthClick() {
            if (CLIENT_ID.includes('MASUKKAN')) {
                alert("Kesalahan: Anda belum memasukkan Client ID di dalam kode index.html!");
                log("Client ID kosong", "error");
                return;
            }

            tokenClient = google.accounts.oauth2.initTokenClient({
                client_id: CLIENT_ID,
                scope: SCOPES,
                callback: (response) => {
                    if (response.access_token) {
                        accessToken = response.access_token;
                        document.getElementById('auth_section').classList.add('hidden');
                        document.getElementById('status_section').classList.remove('hidden');
                        log("Token diterima. Siap beraksi.");
                    }
                },
            });
            tokenClient.requestAccessToken({prompt: 'consent'});
        }

        async function buatFolderTes() {
            log("Mencoba membuat folder di Drive...");
            try {
                const response = await fetch('https://www.googleapis.com/drive/v3/files', {
                    method: 'POST',
                    headers: { 
                        'Authorization': `Bearer ${accessToken}`, 
                        'Content-Type': 'application/json' 
                    },
                    body: JSON.stringify({ 
                        name: 'Opalgas-LifeTime', 
                        mimeType: 'application/vnd.google-apps.folder' 
                    })
                });
                const data = await response.json();
                if (data.id) {
                    log("Sukses! Folder 'Opalgas-LifeTime' dibuat.", "success");
                } else {
                    log("Gagal: " + (data.error ? data.error.message : "Akses ditolak"), "error");
                }
            } catch (e) { 
                log("Error koneksi: " + e.message, "error"); 
            }
        }
    </script>
</body>
</html>
